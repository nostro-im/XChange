# https://taskfile.dev

version: '3'

tasks:
  clean: 
    desc: Clean XChange from local mvn repo
    cmds: 
    - mvn -f ./pom.xml -T 1C build-helper:remove-project-artifact -DskipTests

  clean-module:
    desc: Clean XChange module from local mvn repo. e.g. clean-module PL="xchange-core"
    cmds: 
    - mvn -f ./pom.xml -T 1C build-helper:remove-project-artifact -DskipTests -pl {{.PL}}

  build:
    desc: Build XChange
    deps:
      - task: clean
    cmds:
    - mvn -f ./pom.xml -T 1C clean install -DskipTests
    sources:
    - './**/src/*.java'
    generates:
    - './**/target/*.jar'


  build-module:
    desc: Build XChange modules from arg list. e.g. build-module PL="xchange-core"
    deps:
      - task: clean-module
    cmds:
    - mvn -f ./pom.xml -T 1C clean install -DskipTests -pl {{.PL}}
    sources:
    - './**/src/*.java'
    generates:
    - './**/target/*.jar'

  test:
    desc: Test XChange
    cmds:
    - mvn -f ./pom.xml -T 1C test
    sources:
    - './**/*.java'

  test-module:
    desc: Test XChange particular module. e.g. test-module PL="xchange-core"
    cmds:
    - mvn -f ./pom.xml -T 1C test -pl {{.PL}}
    sources:
    - './**/*.java'
